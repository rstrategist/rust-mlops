name: Script checks

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  scripts:
    name: Verify helper scripts
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Check scripts exist and are executable
        run: |
          set -euo pipefail
          scripts=(
            "scripts/run_translate.sh"
            "scripts/run_heavy_translate.sh"
            "scripts/build-with-libtorch.sh"
          )
          for s in "${scripts[@]}"; do
            if [[ ! -f "$s" ]]; then
              echo "ERROR: missing $s"
              exit 1
            fi
            if [[ ! -x "$s" ]]; then
              echo "ERROR: $s is not executable (missing executable bit)"
              ls -l "$s"
              exit 1
            fi
            # ensure it starts with a shebang
            head -n 1 "$s" | grep -q '^#!' || (echo "ERROR: $s has no shebang" && exit 1)
          done
          echo "All scripts present, executable, and have shebangs."
